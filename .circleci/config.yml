# Use the latest 2.1 version of CircleCI pipeline process engine. See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1

jobs:
  "setup":
    docker:
      - image: instapy/instapy
    working_directory: ~/instaBot
    steps:
      - checkout
      - run: sudo apt-get update --fix-missing
      - run: sudo apt-get -y upgrade
      - run: sudo apt-get -y install unzip python3-pip python3-dev build-essential libssl-dev libffi-dev xvfb
      - run: sudo pip3 install --upgrade pip
      - run: export LANGUAGE=en_US.UTF-8
      - run: export LANG=en_US.UTF-8
      - run: export LC_ALL=en_US.UTF-8
      - run: locale-gen en_US.UTF-8
      - run: sudo dpkg-reconfigure locales
      - run: pip3 install --upgrade pip

      - run:
          name: "Run Bot"
          command: |
            python3 ./instabot.py
      - run:
          name: "End"
          command: |
            echo "End"
  
workflows:
  version: 2
  build:
    jobs:
      - "setup"
